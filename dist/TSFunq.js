/**
 * TSFunq v.1.0.0 - Funq Dependency injection container port for TypeScript
 * Copyright (c) 2015 Sagi Fogel
 * MIT License
 * https://github.com/sagifogel/TSFunq
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.TSFunq=e()}}(function(){return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){var r=e("./Owner"),i=e("./Dictionary"),o=e("./ServiceKey"),s=e("./ReuseScope"),a=e("./NameResolver"),u=e("./GenericServiceEntry"),c=function(){function e(){this.defaultOwner=r.Owner.container,this.defaultReuse=s.ReuseScope.container,this.disposables=new Array,this.childContainers=new Array,this.services=new i.Dictionary;var t=u.GenericServiceEntry.build({instance:this,factory:function(e){return e},container:this,owner:r.Owner.external,reuse:s.ReuseScope.container});this.services.add(new o.ServiceKey(e),t)}return e.prototype.createChildContainer=function(){var t=new e;return t.parent=this,this.childContainers.push(t),t},e.prototype.dispose=function(){for(;this.disposables.length>0;){var e=this.disposables.shift();e.dispose()}for(;this.childContainers.length>0;)this.childContainers.shift().dispose()},e.prototype.register=function(e,t){return this.registerNamed(e,null,t)},e.prototype.registerInstance=function(e){this.registerNamedInstance(null,e)},e.prototype.registerNamedInstance=function(e,t){var n=Object.getPrototypeOf(t),i=n.constructor,o=this.registerImpl(i,e,null);o.reusedWithin(s.ReuseScope.hierarchy).ownedBy(r.Owner.external),o.initializeInstance(t)},e.prototype.registerNamed=function(e,t,n){return this.registerImpl(e,t,n)},e.prototype.registerImpl=function(t,n,r){var i,s;if(t===e)throw new Error("Container service is built-in and read-only.");return s=u.GenericServiceEntry.build({container:this,factory:r,reuse:this.defaultReuse,owner:this.defaultOwner}),i=new o.ServiceKey(t,n),this.services.add(i,s),s},e.prototype.resolve=function(e){return this.resolveNamed(e,null)},e.prototype.resolveNamed=function(e,t){return this.resolveImpl(e,t,!0)},e.prototype.tryResolve=function(e){return this.tryResolveNamed(e,null)},e.prototype.tryResolveNamed=function(e,t){return this.resolveImpl(e,t,!1)},e.prototype.lazyResolve=function(e){return this.lazyResolveNamed(e,null)},e.prototype.lazyResolveNamed=function(e,t){var n=this;return this.throwIfNotRegistered(e,t),function(){return n.resolveNamed(e,t)}},e.prototype.resolveImpl=function(e,t,n){var r,i=this.getEntry(e,t,n);return i?(r=i.instance,r||(r=i.factory(i.container),i.initializeInstance(r)),r):null},e.prototype.getEntry=function(e,t,n){for(var r,i=this,a=new o.ServiceKey(e,t),u={};!i.services.tryGetValue(a,u)&&i.parent;)i=i.parent;return r=u.out,r?r.reuse===s.ReuseScope.container&&r.container!==this&&(r=r.cloneFor(this),this.services.add(a,r)):n&&this.throwMissing(e,t),r},e.prototype.throwMissing=function(e,t){var n=["Required dependency of type "+a.NameResolver.resolve(e)];throw t&&n.push(" named "+t),n.push(" could not be resolved."),new Error(n.join(""))},e.prototype.throwIfNotRegistered=function(e,t){this.getEntry(e,t,!0)},e.prototype.trackDisposable=function(e){this.disposables.push(e)},e}();n.Container=c},{"./Dictionary":2,"./GenericServiceEntry":4,"./NameResolver":5,"./Owner":6,"./ReuseScope":7,"./ServiceKey":9}],2:[function(e,t,n){var r=function(){function e(){}return e.prototype.add=function(e,t){this[e.getHashCode()]=t},e.prototype.tryGetValue=function(e,t){var n=this[e.getHashCode()];return n?(t.out=n,!0):!1},e}();n.Dictionary=r},{}],3:[function(e,t,n){var r=function(){function e(e){this.value=e}return e.prototype.getHashCode=function(){for(var e=this.value,t=0,n=0,r=e.length;r>n;)t=(t<<5)-t+e.charCodeAt(n++)<<0;return t},e}();n.EquatbaleString=r},{}],4:[function(e,t,n){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("./Owner"),o=e("./ReuseScope"),s=e("./ServiceEntry"),a=function(e){function t(t){e.call(this),this.factory=t}return r(t,e),t.prototype.initializeInstance=function(e){var t=e;this.reuse!==o.ReuseScope.none&&(this.instance=e),this.owner===i.Owner.container&&t.dispose&&this.container.trackDisposable(t),this.initializer&&this.initializer(this.container,e)},t.prototype.initializedBy=function(e){return this.initializer=e,this},t.prototype.cloneFor=function(e){return t.build({reuse:this.reuse,owner:this.owner,factory:this.factory,container:e,initializer:this.initializer})},t.build=function(e){var n=new t(e.factory);return n.owner=e.owner,n.reuse=e.reuse,n.instance=e.instance,n.container=e.container,n.initializer=e.initializer,n},t}(s.ServiceEntry);n.GenericServiceEntry=a},{"./Owner":6,"./ReuseScope":7,"./ServiceEntry":8}],5:[function(e,t,n){var r=function(){function e(){}return e.resolve=function(t){return t.name||e.resolveByCode(t)},e.resolveByCode=function(t){var n=t.toString().match(e.nameRegex);return n&&n.length>0&&n[1]||e.resolveByPrototype(t)},e.resolveByPrototype=function(e){var t=new Array,n=e.prototype;for(var r in n)t.push(r);return t.join("")},e.nameRegex=/function ([^\(]+)/,e}();n.NameResolver=r},{}],6:[function(e,t,n){var r;!function(e){e[e.container=0]="container",e[e.external=1]="external"}(r||(r={})),n.Owner=r},{}],7:[function(e,t,n){var r;!function(e){e[e.container=0]="container",e[e.hierarchy=1]="hierarchy",e[e.none=2]="none"}(r||(r={})),n.ReuseScope=r},{}],8:[function(e,t,n){var r=function(){function e(){}return e.prototype.ownedBy=function(e){this.owner=e},e.prototype.reusedWithin=function(e){return this.reuse=e,this},e}();n.ServiceEntry=r},{}],9:[function(e,t,n){var r=e("./NameResolver"),i=e("./EquatbaleString"),o=function(){function e(e,t){this.ctor=e,this.serviceName=t;var n=r.NameResolver.resolve(e),o=new i.EquatbaleString(n);if(this.hash=o.getHashCode(),t){var s=new i.EquatbaleString(t);this.hash^=s.getHashCode()}}return e.prototype.getHashCode=function(){return this.hash},e}();n.ServiceKey=o},{"./EquatbaleString":3,"./NameResolver":5}],10:[function(e,t,n){var r=e("./Owner");n.Owner=r.Owner;var i=e("./Container");n.Container=i.Container;var o=e("./ReuseScope");n.ReuseScope=o.ReuseScope},{"./Container":1,"./Owner":6,"./ReuseScope":7}]},{},[10])(10)});