/**
 * TSFunq v.1.0.0 - Funq Dependency injection container port for TypeScript
 * Copyright (c) 2015 Sagi Fogel
 * MIT License
 * https://github.com/sagifogel/TSFunq
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.TSFunq=e()}}(function(){return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=n[s]={exports:{}};t[s][0].call(p.exports,function(e){var n=t[s][1][e];return i(n?n:e)},p,p.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){var r=e("./Stack"),i=e("./Dictionary"),o=e("./ServiceKey"),s=e("./GenericServiceEntry"),a=e("./ResolutionException"),u=e("./RegistrationException"),c=e("./Owner"),p=e("./ReuseScope"),f=function(){function e(){this.defaultOwner=c.Owner.container,this.defaultReuse=p.ReuseScope.container,this.disposables=new r.Stack,this.childContainers=new r.Stack,this.services=new i.Dictionary;var t=s.GenericServiceEntry.build({instance:this,factory:function(e){return e},container:this,owner:c.Owner.external,reuse:p.ReuseScope.container});this.services.add(new o.ServiceKey(e),t)}return e.prototype.createChildContainer=function(){var t=new e;return t.parent=this,this.childContainers.push(t),t},e.prototype.dispose=function(){for(;this.disposables.length>0;){var e=this.disposables.pop();e.dispose()}for(;this.childContainers.length>0;)this.childContainers.pop().dispose()},e.prototype.register=function(e,t){return this.registerNamed(e,null,t)},e.prototype.registerInstance=function(e){this.registerNamedInstance(null,e)},e.prototype.registerNamedInstance=function(e,t){var n=Object.getPrototypeOf(t),r=n.constructor,i=this.registerImpl(r,e,null);i.reusedWithin(p.ReuseScope.hierarchy).ownedBy(c.Owner.external),i.initializeInstance(t)},e.prototype.registerNamed=function(e,t,n){return this.registerImpl(e,t,n)},e.prototype.registerImpl=function(t,n,r){var i,a;if(t===e)throw new u.RegistrationException("Container service is built-in and read-only.");return a=s.GenericServiceEntry.build({container:this,factory:r,reuse:this.defaultReuse,owner:this.defaultOwner}),i=new o.ServiceKey(t,n),this.services.add(i,a),a},e.prototype.resolve=function(e){return this.resolveNamed(e,null)},e.prototype.resolveNamed=function(e,t){return this.resolveImpl(e,t,!0)},e.prototype.tryResolve=function(e){return this.tryResolveNamed(e,null)},e.prototype.tryResolveNamed=function(e,t){return this.resolveImpl(e,t,!1)},e.prototype.lazyResolve=function(e){return this.lazyResolveNamed(e,null)},e.prototype.lazyResolveNamed=function(e,t){var n=this;return this.throwIfNotRegistered(e,t),function(){return n.resolveNamed(e,t)}},e.prototype.resolveImpl=function(e,t,n){var r,i=this.getEntry(e,t,n);return i?(r=i.instance,r||(r=i.factory(i.container),i.initializeInstance(r)),r):null},e.prototype.getEntry=function(e,t,n){for(var r,i=this,s=new o.ServiceKey(e,t),u={};!i.services.tryGetValue(s,u)&&i.parent;)i=i.parent;if(r=u.out)r.reuse===p.ReuseScope.container&&r.container!==this&&(r=r.cloneFor(this),this.services.add(s,r));else if(n)throw new a.ResolutionException(e,t);return r},e.prototype.throwIfNotRegistered=function(e,t){this.getEntry(e,t,!0)},e.prototype.trackDisposable=function(e){this.disposables.push(e)},e}();n.Container=f},{"./Dictionary":2,"./GenericServiceEntry":4,"./Owner":6,"./RegistrationException":7,"./ResolutionException":8,"./ReuseScope":9,"./ServiceKey":11,"./Stack":12}],2:[function(e,t,n){var r=function(){function e(e){void 0===e&&(e=[]);for(var t=0;t<e.length;t++){var n=e[t];this[n.key.getHashCode()]=n.value}}return e.prototype.add=function(e,t){this[e.getHashCode()]=t},e.prototype.remove=function(e){delete this[e.getHashCode()]},e.prototype.containsKey=function(e){return!!this[e.getHashCode()]},e.prototype.tryGetValue=function(e,t){var n=this[e.getHashCode()];return n?(t.out=n,!0):!1},e}();n.Dictionary=r},{}],3:[function(e,t,n){var r=function(){function e(e){this.value=e}return e.prototype.equals=function(e){return this.getHashCode()===e.getHashCode()},e.prototype.getHashCode=function(){for(var e=this.value,t=0,n=0,r=e.length;r>n;)t=(t<<5)-t+e.charCodeAt(n++)<<0;return t},e}();n.EquatbaleString=r},{}],4:[function(e,t,n){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("./ServiceEntry"),o=e("./Owner"),s=e("./ReuseScope"),a=function(e){function t(t){e.call(this),this.factory=t}return r(t,e),t.prototype.initializeInstance=function(e){var t=e;this.reuse!==s.ReuseScope.none&&(this.instance=e),this.owner===o.Owner.container&&t.dispose&&this.container.trackDisposable(t),this.initializer&&this.initializer(this.container,e)},t.prototype.initializedBy=function(e){return this.initializer=e,this},t.prototype.cloneFor=function(e){return t.build({reuse:this.reuse,owner:this.owner,factory:this.factory,container:e,initializer:this.initializer})},t.build=function(e){var n=new t(e.factory);return n.owner=e.owner,n.reuse=e.reuse,n.instance=e.instance,n.container=e.container,n.initializer=e.initializer,n},t}(i.ServiceEntry);n.GenericServiceEntry=a},{"./Owner":6,"./ReuseScope":9,"./ServiceEntry":10}],5:[function(e,t,n){var r=function(){function e(){}return e.resolve=function(t){return t.name||e.resolveByCode(t)},e.resolveByCode=function(t){var n=t.toString().match(e.nameRegex);return n&&n.length>0&&n[1]||e.resolveByPrototype(t)},e.resolveByPrototype=function(e){var t=new Array,n=e.prototype;for(var r in n)t.push(r);return t.join("")},e.nameRegex=/function ([^\(]+)/,e}();n.NameResolver=r},{}],6:[function(e,t,n){var r;!function(e){e[e.container=0]="container",e[e.external=1]="external"}(r||(r={})),n.Owner=r},{}],7:[function(e,t,n){var r=function(){function e(e){this.message=e,this.name="RegistrationException"}return e}();n.RegistrationException=r},{}],8:[function(e,t,n){var r=e("./NameResolver"),i=function(){function e(e,t){this.name="ResolutionException";var n=["Required dependency of type "+r.NameResolver.resolve(e)];t&&n.push(" named "+t),n.push(" could not be resolved."),this.message=n.join("")}return e}();n.ResolutionException=i},{"./NameResolver":5}],9:[function(e,t,n){var r;!function(e){e[e.container=0]="container",e[e.hierarchy=1]="hierarchy",e[e.none=2]="none"}(r||(r={})),n.ReuseScope=r},{}],10:[function(e,t,n){var r=function(){function e(){}return e.prototype.ownedBy=function(e){this.owner=e},e.prototype.reusedWithin=function(e){return this.reuse=e,this},e}();n.ServiceEntry=r},{}],11:[function(e,t,n){var r=e("./NameResolver"),i=e("./EquatbaleString"),o=function(){function e(e,t){this.ctor=e,this.serviceName=t;var n=r.NameResolver.resolve(e),o=new i.EquatbaleString(n);if(this.hash=o.getHashCode(),t){var s=new i.EquatbaleString(t);this.hash^=s.getHashCode()}}return e.prototype.equals=function(e){return e&&e.getHashCode?e.getHashCode()===this.getHashCode():!1},e.prototype.getHashCode=function(){return this.hash},e}();n.ServiceKey=o},{"./EquatbaleString":3,"./NameResolver":5}],12:[function(e,t,n){var r=function(){function e(){this.arr=new Array}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.arr.length=0},e.prototype.contains=function(e){return this.arr.indexOf(e)>-1},e.prototype.peek=function(){return this.arr[0]},e.prototype.pop=function(){return this.arr.shift()},e.prototype.push=function(e){this.arr.push(e)},e}();n.Stack=r},{}],13:[function(e,t,n){var r=e("./Container");n.Container=r.Container;var i=e("./Owner");n.Owner=i.Owner;var o=e("./ReuseScope");n.ReuseScope=o.ReuseScope},{"./Container":1,"./Owner":6,"./ReuseScope":9}]},{},[13])(13)});